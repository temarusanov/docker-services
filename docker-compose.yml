version: '3.1'

services:

  adminer:
    image: adminer
    restart: always
    container_name: adminer
    environment:
      ADMINER_PLUGINS: tables-filter tinymce
      ADMINER_DESIGN: lucas-sandery
    ports:
      - 8080:8080

  postgres:
    image: postgres:13.1
    restart: always
    container_name: postgres
    environment:
      POSTGRES_USER: user
      POSTGRES_PASSWORD: secret
    volumes:
      - ./runtime/postgres:/var/lib/postgresql/data
      - ./postgres/postgresql.conf:/etc/postgresql/postgresql.conf
    ports:
      - 5432:5432

  rabbitmq:
    image: rabbitmq:3-management
    restart: always
    container_name: rabbitmq
    environment:
      - RABBITMQ_DEFAULT_USER=guest
      - RABBITMQ_DEFAULT_PASS=guest
      - RABBITMQ_SERVER_ADDITIONAL_ERL_ARGS=-rabbitmq_management load_definitions "/etc/rabbitmq/rabbit.json"
    hostname: rabbitmq
    volumes:
      - ./runtime/rabbitmq:/var/lib/rabbitmq
      - ./rabbitmq/rabbit.json:/etc/rabbitmq/rabbit.json
    ports:
      - "15672:15672"
      - "5672:5672"

  redis:
    image: redis
    container_name: redis
    environment:
      - REDIS_PASSWORD=secret
    volumes:
      - ./runtime/redis:/bitnami/redis/data
      - ./redis/redis.conf:/usr/local/etc/redis/redis.conf
    ports:
      - "6379:6379"
    